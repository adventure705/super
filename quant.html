<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í€€íŠ¸ ìˆ˜ëŸ‰ ê³„ì‚°ê¸°</title>
    <!-- Tailwind CSS CDN ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter í°íŠ¸ ì„¤ì • ë° ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f7f9;
        }
        /* ì…ë ¥ í•„ë“œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì¡°ì • */
        /* type="text"ë¡œ ë³€ê²½í–ˆìœ¼ë¯€ë¡œ number input ê´€ë ¨ CSS ì œê±° */
        input[type="text"] {
            /* ëª¨ë“  ìˆ«ì ì…ë ¥ í•„ë“œì— bodyì˜ font-family(Inter) ì ìš© */
            font-family: 'Inter', sans-serif; 
        }
        /* ê°€ë¡œ ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        .overflow-x-auto::-webkit-scrollbar {
            height: 8px;
        }
        .overflow-x-auto::-webkit-scrollbar-thumb {
            background-color: #cbd5e1; /* gray-300 */
            border-radius: 4px;
        }
        .overflow-x-auto::-webkit-scrollbar-track {
            background-color: #f1f1f1;
        }
    </style>
</head>
<!-- ëª¨ë°”ì¼: p-2 (íƒ€ì´íŠ¸), PC: lg:p-4 (ì ë‹¹) -->
<body class="p-2 lg:p-4 flex flex-col items-center justify-start min-h-screen"> 

    <!-- ëª¨ë°”ì¼: space-y-2 (íƒ€ì´íŠ¸), PC: lg:space-y-8 (ì ë‹¹) -->
    <div class="w-full max-w-7xl space-y-2 lg:space-y-8">
        <!-- íƒ€ì´í‹€ í¬ê¸° ì¡°ì • (ëª¨ë°”ì¼: 3xl, PC: 4xl) -->
        <h1 class="text-3xl lg:text-4xl font-extrabold text-gray-800 text-center">í€€íŠ¸ ìˆ˜ëŸ‰ ê³„ì‚°ê¸°</h1>
        
        <!-- === [ START: Unified Total Amount Input ] === -->
        <div class="w-full p-3 bg-white rounded-xl shadow-2xl border-4 border-indigo-400">
            <label for="totalAmount" class="block text-base font-bold text-gray-800 mb-1">
                ğŸ’° ì´ ê¸ˆì•¡ (USD)
            </label>
            <!-- type="text" ë° inputmode="decimal"ë¡œ ë³€ê²½ -->
            <input type="text" inputmode="decimal" id="totalAmount" placeholder="ì´ ê¸ˆì•¡(ìˆ«ìë§Œ)ì„ ì…ë ¥í•˜ì„¸ìš”" min="0"
                   class="w-full p-3 border border-gray-400 rounded-lg text-xl text-right focus:ring-blue-500 focus:border-blue-500 transition duration-150"
                   oninput="calculateAll()">
        </div>
        <!-- === [ END: Unified Total Amount Input ] === -->

        <!-- ì„¸ ê°œì˜ ê³„ì‚°ê¸° ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë‹´ëŠ” ì»¨í…Œì´ë„ˆ: space-x-2 (ê°„ê²© ìµœì†Œí™”)
             PC í™˜ê²½ì—ì„œëŠ” 4ì—´ ê·¸ë¦¬ë“œë¡œ ë³€ê²½ (lg:grid-cols-4) -->
        <div class="flex space-x-2 pb-4 overflow-x-auto lg:grid lg:grid-cols-4 lg:gap-4 lg:space-x-0 lg:overflow-visible">

            <!-- ============================================== -->
            <!-- ê³„ì‚°ê¸° ì¸ìŠ¤í„´ìŠ¤ 1: min-w-[300px]ë¡œ ë„ˆë¹„ ì¡°ì • -->
            <!-- ============================================== -->
            <div id="calculator-1" class="flex-none min-w-[300px] lg:min-w-0 bg-white shadow-xl rounded-xl p-4 space-y-4 border-4 border-indigo-400">
                <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-3">ê³„ì‚°ê¸° 1ï¸âƒ£</h2> 
                
                <!-- ì…ë ¥ í•„ë“œ ê·¸ë£¹ ë° ì¤‘ê°„ ê²°ê³¼ í¬í•¨ -->
                <div class="space-y-3">
                    <!-- ë°±ë¶„ìœ¨ ì…ë ¥ -->
                    <div>
                        <label for="percentage1" class="block text-sm font-medium text-gray-700 mb-1">ë¹„ìœ¨ (%)</label>
                        <div class="relative">
                            <!-- type="text" ë° inputmode="decimal"ë¡œ ë³€ê²½ -->
                            <input type="text" inputmode="decimal" id="percentage1" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 pr-10 text-right"
                                   oninput="calculateQuantity(1)">
                            <span class="absolute right-0 top-0 h-full flex items-center pr-3 text-gray-500 text-sm">%</span>
                        </div>
                    </div>

                    <!-- ë¹„ìœ¨ ê¸ˆì•¡ (ì¤‘ê°„ ê²°ê³¼) - ìƒ‰ìƒ ì—°í•˜ê²Œ ë³€ê²½ -->
                    <div class="flex justify-between items-center bg-gray-50 p-3 rounded-lg border border-gray-200 shadow-inner">
                        <span class="text-base font-semibold text-gray-700">ë¹„ìœ¨ ê¸ˆì•¡</span>
                        <span id="adjustedAmountDisplay1" class="text-xl font-extrabold text-blue-700">0.00</span>
                    </div>

                    <!-- ë‹¨ìœ„ ê°€ê²© ì…ë ¥ -->
                    <div>
                        <label for="unitPrice1" class="block text-sm font-medium text-gray-700 mb-1">ë‹¨ìœ„ ê°€ê²© (ë§¤ìˆ˜/ë§¤ë„ê°€)</label>
                        <!-- type="text" ë° inputmode="decimal"ë¡œ ë³€ê²½ -->
                        <input type="text" inputmode="decimal" id="unitPrice1" min="0.01" step="any"
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 text-right"
                               oninput="calculateQuantity(1)">
                    </div>
                </div>

                <!-- ìµœì¢… ìˆ˜ëŸ‰ ê²°ê³¼ í‘œì‹œ ì„¹ì…˜ - ë°°ê²½ìƒ‰ ì§„í•˜ê²Œ ë³€ê²½ + ëª¨ë°”ì¼ 2ì—´ -->
                <div class="bg-indigo-700 p-4 rounded-lg space-y-3 shadow-2xl">
                    <h3 class="text-lg font-semibold text-white border-b border-indigo-500 pb-2">ìµœì¢… ìˆ˜ëŸ‰ ê²°ê³¼</h3>

                    <!-- New Responsive Result Grid (2 Columns on Mobile) -->
                    <div class="grid grid-cols-2 gap-2">
                        <!-- Decimal Column -->
                        <div class="flex flex-col items-center bg-indigo-500 p-2 rounded-lg shadow-sm">
                            <span class="text-xs font-semibold text-white mb-1 opacity-80">ì†Œìˆ˜ì  2ìë¦¬</span>
                            <span id="quantityDecimal1" class="text-xl font-extrabold text-white truncate">0.00</span>
                        </div>

                        <!-- Integer Column: í¬ê¸° í†µì¼ ë° ìƒ‰ìƒ ê°•ì¡° -->
                        <div class="flex flex-col items-center bg-indigo-900 p-2 rounded-lg shadow-xl">
                            <span class="text-xs font-semibold text-indigo-200 mb-1 opacity-80">ë°˜ì˜¬ë¦¼ ì •ìˆ˜</span>
                            <span id="quantityInteger1" class="text-xl font-extrabold text-red-400 truncate">0</span>
                        </div>
                    </div>
                </div>

                <!-- ì—ëŸ¬ ë©”ì‹œì§€: text-xsì™€ h-6 ì ìš©ìœ¼ë¡œ ì¤„ë°”ê¿ˆ ë° ë„˜ì¹¨ ë°©ì§€ -->
                <p id="errorMessage1" class="text-red-600 text-xs text-center font-medium h-6"></p>
            </div>


            <!-- ============================================== -->
            <!-- ê³„ì‚°ê¸° ì¸ìŠ¤í„´ìŠ¤ 2: min-w-[300px]ë¡œ ë„ˆë¹„ ì¡°ì • -->
            <!-- ============================================== -->
            <div id="calculator-2" class="flex-none min-w-[300px] lg:min-w-0 bg-white shadow-xl rounded-xl p-4 space-y-4 border-4 border-indigo-400">
                <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-3">ê³„ì‚°ê¸° 2ï¸âƒ£</h2>
                
                <!-- ì…ë ¥ í•„ë“œ ê·¸ë£¹ ë° ì¤‘ê°„ ê²°ê³¼ í¬í•¨ -->
                <div class="space-y-3">
                    <!-- ë°±ë¶„ìœ¨ ì…ë ¥ -->
                    <div>
                        <label for="percentage2" class="block text-sm font-medium text-gray-700 mb-1">ë¹„ìœ¨ (%)</label>
                        <div class="relative">
                            <!-- type="text" ë° inputmode="decimal"ë¡œ ë³€ê²½ -->
                            <input type="text" inputmode="decimal" id="percentage2" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 pr-10 text-right"
                                   oninput="calculateQuantity(2)">
                            <span class="absolute right-0 top-0 h-full flex items-center pr-3 text-gray-500 text-sm">%</span>
                        </div>
                    </div>

                    <!-- ë¹„ìœ¨ ê¸ˆì•¡ (ì¤‘ê°„ ê²°ê³¼) - ìƒ‰ìƒ ì—°í•˜ê²Œ ë³€ê²½ -->
                    <div class="flex justify-between items-center bg-gray-50 p-3 rounded-lg border border-gray-200 shadow-inner">
                        <span class="text-base font-semibold text-gray-700">ë¹„ìœ¨ ê¸ˆì•¡</span>
                        <span id="adjustedAmountDisplay2" class="text-xl font-extrabold text-blue-700">0.00</span>
                    </div>

                    <!-- ë‹¨ìœ„ ê°€ê²© ì…ë ¥ -->
                    <div>
                        <label for="unitPrice2" class="block text-sm font-medium text-gray-700 mb-1">ë‹¨ìœ„ ê°€ê²© (ë§¤ìˆ˜/ë§¤ë„ê°€)</label>
                        <!-- type="text" ë° inputmode="decimal"ë¡œ ë³€ê²½ -->
                        <input type="text" inputmode="decimal" id="unitPrice2" min="0.01" step="any"
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 text-right"
                               oninput="calculateQuantity(2)">
                    </div>
                </div>

                <!-- ìµœì¢… ìˆ˜ëŸ‰ ê²°ê³¼ í‘œì‹œ ì„¹ì…˜ - ë°°ê²½ìƒ‰ ì§„í•˜ê²Œ ë³€ê²½ + ëª¨ë°”ì¼ 2ì—´ -->
                <div class="bg-indigo-700 p-4 rounded-lg space-y-3 shadow-2xl">
                    <h3 class="text-lg font-semibold text-white border-b border-indigo-500 pb-2">ìµœì¢… ìˆ˜ëŸ‰ ê²°ê³¼</h3>

                    <!-- New Responsive Result Grid (2 Columns on Mobile) -->
                    <div class="grid grid-cols-2 gap-2">
                        <!-- Decimal Column -->
                        <div class="flex flex-col items-center bg-indigo-500 p-2 rounded-lg shadow-sm">
                            <span class="text-xs font-semibold text-white mb-1 opacity-80">ì†Œìˆ˜ì  2ìë¦¬</span>
                            <span id="quantityDecimal2" class="text-xl font-extrabold text-white truncate">0.00</span>
                        </div>

                        <!-- Integer Column: í¬ê¸° í†µì¼ ë° ìƒ‰ìƒ ê°•ì¡° -->
                        <div class="flex flex-col items-center bg-indigo-900 p-2 rounded-lg shadow-xl">
                            <span class="text-xs font-semibold text-indigo-200 mb-1 opacity-80">ë°˜ì˜¬ë¦¼ ì •ìˆ˜</span>
                            <span id="quantityInteger2" class="text-xl font-extrabold text-red-400 truncate">0</span>
                        </div>
                    </div>
                </div>

                <!-- ì—ëŸ¬ ë©”ì‹œì§€: text-xsì™€ h-6 ì ìš©ìœ¼ë¡œ ì¤„ë°”ê¿ˆ ë° ë„˜ì¹¨ ë°©ì§€ -->
                <p id="errorMessage2" class="text-red-600 text-xs text-center font-medium h-6"></p>
            </div>


            <!-- ============================================== -->
            <!-- ê³„ì‚°ê¸° ì¸ìŠ¤í„´ìŠ¤ 3: min-w-[300px]ë¡œ ë„ˆë¹„ ì¡°ì • -->
            <!-- ============================================== -->
            <div id="calculator-3" class="flex-none min-w-[300px] lg:min-w-0 bg-white shadow-xl rounded-xl p-4 space-y-4 border-4 border-indigo-400">
                <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-3">ê³„ì‚°ê¸° 3ï¸âƒ£</h2>
                
                <!-- ì…ë ¥ í•„ë“œ ê·¸ë£¹ ë° ì¤‘ê°„ ê²°ê³¼ í¬í•¨ -->
                <div class="space-y-3">
                    <!-- ë°±ë¶„ìœ¨ ì…ë ¥ -->
                    <div>
                        <label for="percentage3" class="block text-sm font-medium text-gray-700 mb-1">ë¹„ìœ¨ (%)</label>
                        <div class="relative">
                            <!-- type="text" ë° inputmode="decimal"ë¡œ ë³€ê²½ -->
                            <input type="text" inputmode="decimal" id="percentage3" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 pr-10 text-right"
                                   oninput="calculateQuantity(3)">
                            <span class="absolute right-0 top-0 h-full flex items-center pr-3 text-gray-500 text-sm">%</span>
                        </div>
                    </div>

                    <!-- ë¹„ìœ¨ ê¸ˆì•¡ (ì¤‘ê°„ ê²°ê³¼) - ìƒ‰ìƒ ì—°í•˜ê²Œ ë³€ê²½ -->
                    <div class="flex justify-between items-center bg-gray-50 p-3 rounded-lg border border-gray-200 shadow-inner">
                        <span class="text-base font-semibold text-gray-700">ë¹„ìœ¨ ê¸ˆì•¡</span>
                        <span id="adjustedAmountDisplay3" class="text-xl font-extrabold text-blue-700">0.00</span>
                    </div>

                    <!-- ë‹¨ìœ„ ê°€ê²© ì…ë ¥ -->
                    <div>
                        <label for="unitPrice3" class="block text-sm font-medium text-gray-700 mb-1">ë‹¨ìœ„ ê°€ê²© (ë§¤ìˆ˜/ë§¤ë„ê°€)</label>
                        <!-- type="text" ë° inputmode="decimal"ë¡œ ë³€ê²½ -->
                        <input type="text" inputmode="decimal" id="unitPrice3" min="0.01" step="any"
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 text-right"
                               oninput="calculateQuantity(3)">
                    </div>
                </div>

                <!-- ìµœì¢… ìˆ˜ëŸ‰ ê²°ê³¼ í‘œì‹œ ì„¹ì…˜ - ë°°ê²½ìƒ‰ ì§„í•˜ê²Œ ë³€ê²½ + ëª¨ë°”ì¼ 2ì—´ -->
                <div class="bg-indigo-700 p-4 rounded-lg space-y-3 shadow-2xl">
                    <h3 class="text-lg font-semibold text-white border-b border-indigo-500 pb-2">ìµœì¢… ìˆ˜ëŸ‰ ê²°ê³¼</h3>

                    <!-- New Responsive Result Grid (2 Columns on Mobile) -->
                    <div class="grid grid-cols-2 gap-2">
                        <!-- Decimal Column -->
                        <div class="flex flex-col items-center bg-indigo-500 p-2 rounded-lg shadow-sm">
                            <span class="text-xs font-semibold text-white mb-1 opacity-80">ì†Œìˆ˜ì  2ìë¦¬</span>
                            <span id="quantityDecimal3" class="text-xl font-extrabold text-white truncate">0.00</span>
                        </div>

                        <!-- Integer Column: í¬ê¸° í†µì¼ ë° ìƒ‰ìƒ ê°•ì¡° -->
                        <div class="flex flex-col items-center bg-indigo-900 p-2 rounded-lg shadow-xl">
                            <span class="text-xs font-semibold text-indigo-200 mb-1 opacity-80">ë°˜ì˜¬ë¦¼ ì •ìˆ˜</span>
                            <span id="quantityInteger3" class="text-xl font-extrabold text-red-400 truncate">0</span>
                        </div>
                    </div>
                </div>

                <!-- ì—ëŸ¬ ë©”ì‹œì§€: text-xsì™€ h-6 ì ìš©ìœ¼ë¡œ ì¤„ë°”ê¿ˆ ë° ë„˜ì¹¨ ë°©ì§€ -->
                <p id="errorMessage3" class="text-red-600 text-xs text-center font-medium h-6"></p>
            </div>

            <!-- ============================================== -->
            <!-- ê³„ì‚°ê¸° ì¸ìŠ¤í„´ìŠ¤ 4: min-w-[300px]ë¡œ ë„ˆë¹„ ì¡°ì • -->
            <!-- ============================================== -->
            <div id="calculator-4" class="flex-none min-w-[300px] lg:min-w-0 bg-white shadow-xl rounded-xl p-4 space-y-4 border-4 border-indigo-400">
                <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-3">ê³„ì‚°ê¸° 4ï¸âƒ£</h2>
                
                <!-- ì…ë ¥ í•„ë“œ ê·¸ë£¹ ë° ì¤‘ê°„ ê²°ê³¼ í¬í•¨ -->
                <div class="space-y-3">
                    <!-- ë°±ë¶„ìœ¨ ì…ë ¥ -->
                    <div>
                        <label for="percentage4" class="block text-sm font-medium text-gray-700 mb-1">ë¹„ìœ¨ (%)</label>
                        <div class="relative">
                            <!-- type="text" ë° inputmode="decimal"ë¡œ ë³€ê²½ -->
                            <input type="text" inputmode="decimal" id="percentage4" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 pr-10 text-right"
                                   oninput="calculateQuantity(4)">
                            <span class="absolute right-0 top-0 h-full flex items-center pr-3 text-gray-500 text-sm">%</span>
                        </div>
                    </div>

                    <!-- ë¹„ìœ¨ ê¸ˆì•¡ (ì¤‘ê°„ ê²°ê³¼) - ìƒ‰ìƒ ì—°í•˜ê²Œ ë³€ê²½ -->
                    <div class="flex justify-between items-center bg-gray-50 p-3 rounded-lg border border-gray-200 shadow-inner">
                        <span class="text-base font-semibold text-gray-700">ë¹„ìœ¨ ê¸ˆì•¡</span>
                        <span id="adjustedAmountDisplay4" class="text-xl font-extrabold text-blue-700">0.00</span>
                    </div>

                    <!-- ë‹¨ìœ„ ê°€ê²© ì…ë ¥ -->
                    <div>
                        <label for="unitPrice4" class="block text-sm font-medium text-gray-700 mb-1">ë‹¨ìœ„ ê°€ê²© (ë§¤ìˆ˜/ë§¤ë„ê°€)</label>
                        <!-- type="text" ë° inputmode="decimal"ë¡œ ë³€ê²½ -->
                        <input type="text" inputmode="decimal" id="unitPrice4" min="0.01" step="any"
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 text-right"
                               oninput="calculateQuantity(4)">
                    </div>
                </div>

                <!-- ìµœì¢… ìˆ˜ëŸ‰ ê²°ê³¼ í‘œì‹œ ì„¹ì…˜ - ë°°ê²½ìƒ‰ ì§„í•˜ê²Œ ë³€ê²½ + ëª¨ë°”ì¼ 2ì—´ -->
                <div class="bg-indigo-700 p-4 rounded-lg space-y-3 shadow-2xl">
                    <h3 class="text-lg font-semibold text-white border-b border-indigo-500 pb-2">ìµœì¢… ìˆ˜ëŸ‰ ê²°ê³¼</h3>

                    <!-- New Responsive Result Grid (2 Columns on Mobile) -->
                    <div class="grid grid-cols-2 gap-2">
                        <!-- Decimal Column -->
                        <div class="flex flex-col items-center bg-indigo-500 p-2 rounded-lg shadow-sm">
                            <span class="text-xs font-semibold text-white mb-1 opacity-80">ì†Œìˆ˜ì  2ìë¦¬</span>
                            <span id="quantityDecimal4" class="text-xl font-extrabold text-white truncate">0.00</span>
                        </div>

                        <!-- Integer Column: í¬ê¸° í†µì¼ ë° ìƒ‰ìƒ ê°•ì¡° -->
                        <div class="flex flex-col items-center bg-indigo-900 p-2 rounded-lg shadow-xl">
                            <span class="text-xs font-semibold text-indigo-200 mb-1 opacity-80">ë°˜ì˜¬ë¦¼ ì •ìˆ˜</span>
                            <span id="quantityInteger4" class="text-xl font-extrabold text-red-400 truncate">0</span>
                        </div>
                    </div>
                </div>

                <!-- ì—ëŸ¬ ë©”ì‹œì§€: text-xsì™€ h-6 ì ìš©ìœ¼ë¡œ ì¤„ë°”ê¿ˆ ë° ë„˜ì¹¨ ë°©ì§€ -->
                <p id="errorMessage4" class="text-red-600 text-xs text-center font-medium h-6"></p>
            </div>
            
        </div>
    </div>

    <script>
        // Firebase ê´€ë ¨ ì „ì—­ ë³€ìˆ˜ ì„¤ì • (ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ í™˜ê²½ ìš”êµ¬ì‚¬í•­ì„ ìœ„í•´ í¬í•¨)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};

        /**
         * ì„¸ ê°œì˜ ëª¨ë“  ê³„ì‚°ê¸°ë¥¼ ë‹¤ì‹œ ê³„ì‚°í•©ë‹ˆë‹¤.
         * 4ê°œ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì—…ë°ì´íŠ¸ë¨.
         */
        function calculateAll() {
            calculateQuantity(1);
            calculateQuantity(2);
            calculateQuantity(3);
            calculateQuantity(4); // 4ë²ˆì§¸ ê³„ì‚°ê¸° ì¶”ê°€
        }

        /**
         * ì§€ì •ëœ ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ê³„ì‚°ê¸°ì˜ ì…ë ¥ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ìµœì¢… ìˆ˜ëŸ‰ì„ ê³„ì‚°í•˜ê³  ê²°ê³¼ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
         * ê³µí†µ ì´ ê¸ˆì•¡ì€ ë‹¨ì¼ ID 'totalAmount'ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤.
         * @param {number} index - ê³„ì‚°ê¸° ì¸ìŠ¤í„´ìŠ¤ì˜ ì¸ë±ìŠ¤ (1, 2, 3, 4)
         */
        function calculateQuantity(index) {
            // ê³µí†µ ì´ ê¸ˆì•¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const totalAmountInput = document.getElementById('totalAmount');
            
            // ì¸ë±ìŠ¤ì— ë§ëŠ” ê°œë³„ ì…ë ¥ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const percentageInput = document.getElementById(`percentage${index}`);
            const unitPriceInput = document.getElementById(`unitPrice${index}`);

            // Raw value check for empty string
            const rawTotalAmount = totalAmountInput.value;
            const rawPercentage = percentageInput.value;
            const rawUnitPrice = unitPriceInput.value;

            // type="text"ë¡œ ë³€ê²½ë˜ì—ˆìœ¼ë¯€ë¡œ, ì…ë ¥ê°’ì„ ê·¸ëŒ€ë¡œ íŒŒì‹±í•©ë‹ˆë‹¤.
            const totalAmount = parseFloat(rawTotalAmount.replace(/,/g, ''));
            const percentage = parseFloat(rawPercentage.replace(/,/g, ''));
            const unitPrice = parseFloat(rawUnitPrice.replace(/,/g, ''));

            // ì¸ë±ìŠ¤ì— ë§ëŠ” ê²°ê³¼ í‘œì‹œ ìš”ì†Œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const quantityDecimalDisplay = document.getElementById(`quantityDecimal${index}`);
            const quantityIntegerDisplay = document.getElementById(`quantityInteger${index}`);
            const adjustedAmountDisplay = document.getElementById(`adjustedAmountDisplay${index}`);
            const errorMessageDisplay = document.getElementById(`errorMessage${index}`);

            errorMessageDisplay.innerHTML = ''; // innerHTMLë¡œ ë³€ê²½
            let percentageValue = 0;
            let finalQuantity = 0;

            // ì…ë ¥ê°’ ìœ íš¨ì„± ê²€ì‚¬
            const isAmountValid = rawTotalAmount.trim() !== "" && !isNaN(totalAmount) && totalAmount >= 0;
            const isPercentageValid = rawPercentage.trim() !== "" && !isNaN(percentage);
            const isUnitPriceEntered = rawUnitPrice.trim() !== "";
            const isUnitPriceValid = isUnitPriceEntered && !isNaN(unitPrice) && unitPrice > 0;

            
            // --- STEP 1: ë¹„ìœ¨ ê¸ˆì•¡ (ì¤‘ê°„ ê²°ê³¼) ê³„ì‚° ë° í‘œì‹œ ---
            // ì´ ê¸ˆì•¡ê³¼ ë¹„ìœ¨ë§Œ ì…ë ¥ë˜ì–´ë„ ê³„ì‚°ë˜ì–´ì•¼ í•¨
            if (isAmountValid && isPercentageValid) {
                percentageValue = totalAmount * (percentage / 100);
                
                // ë¹„ìœ¨ ê¸ˆì•¡ í‘œì‹œ
                adjustedAmountDisplay.textContent = percentageValue.toLocaleString('ko-KR', {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 2
                });
            } else {
                // ë¹„ìœ¨ ê¸ˆì•¡ ë¦¬ì…‹
                adjustedAmountDisplay.textContent = '0.00';
            }


            // --- STEP 2: ìµœì¢… ìˆ˜ëŸ‰ ê³„ì‚° ë° í‘œì‹œ ---
            // ìµœì¢… ìˆ˜ëŸ‰ì€ ë¹„ìœ¨ ê¸ˆì•¡ê³¼ ë‹¨ìœ„ ê°€ê²©ì´ ëª¨ë‘ ìœ íš¨í•  ë•Œë§Œ ê³„ì‚°
            if (isAmountValid && isPercentageValid && isUnitPriceValid) {
                // ìµœì¢… ìˆ˜ëŸ‰ ê³„ì‚° (ë¹„ìœ¨ ê¸ˆì•¡ / ë‹¨ìœ„ ê°€ê²©)
                finalQuantity = percentageValue / unitPrice;
                
                // ì†Œìˆ˜ì  2ìë¦¬ê¹Œì§€
                const decimalResult = finalQuantity.toFixed(2);
                quantityDecimalDisplay.textContent = decimalResult;

                // ë°˜ì˜¬ë¦¼í•œ ì •ìˆ˜
                const integerResult = Math.round(finalQuantity);
                quantityIntegerDisplay.textContent = integerResult.toLocaleString('ko-KR');

            } else {
                // ìµœì¢… ìˆ˜ëŸ‰ ë¦¬ì…‹
                quantityDecimalDisplay.textContent = '0.00';
                quantityIntegerDisplay.textContent = '0';
                
                // ì—ëŸ¬ ë©”ì‹œì§€/íŒíŠ¸ í‘œì‹œ
                if (isAmountValid && isPercentageValid) {
                    if (isUnitPriceEntered && unitPrice <= 0) {
                        errorMessageDisplay.innerHTML = 'ë‹¨ìœ„ ê°€ê²©ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.';
                    } 
                    // else if (!isUnitPriceEntered) {
                    //     // ìš”ì²­ì— ë”°ë¼ ë‹¨ìœ„ ê°€ê²© ì…ë ¥ ì•ˆë‚´ ë©”ì‹œì§€ ì‚­ì œ
                    //     errorMessageDisplay.innerHTML = 'ìµœì¢… ìˆ˜ëŸ‰ì„ ê³„ì‚°í•˜ë ¤ë©´<br>ë‹¨ìœ„ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš”.';
                    // }
                }
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ê³„ì‚° ì‹¤í–‰ (4ê°œ ì¸ìŠ¤í„´ìŠ¤ ëª¨ë‘)
        window.onload = function() {
            // ëª¨ë“  ì…ë ¥ í•„ë“œê°€ ë¹„ì–´ ìˆìœ¼ë¯€ë¡œ, ëª¨ë“  ê²°ê³¼ëŠ” 0.00ìœ¼ë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.
            calculateAll();
        };
    </script>
</body>
</html>
