<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> ğŸ”’í†µí•© ê´€ë¦¬ì </title>
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ”</text></svg>">
    <style>
        :root {
            /* ë‹¤í¬ ëª¨ë“œ ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ */
            --primary-color: #3b82f6; /* Blue 500 */
            --primary-hover: #2563eb; /* Blue 600 */
            --danger-color: #ef4444; /* Red 500 */
            --warning-color: #f59e0b; /* Amber 500 */
            --success-color: #10b981; /* Emerald 500 */
            
            --bg-color: #0f172a;      /* Slate 900 */
            --card-bg: #1e293b;       /* Slate 800 */
            --input-bg: #334155;      /* Slate 700 */
            --border-color: #475569;  /* Slate 600 */
            
            /* í…ìŠ¤íŠ¸ ì»¬ëŸ¬ */
            --text-main: #ffffff;     /* Pure White */
            --text-sub: #cbd5e1;      /* Slate 300 */
            --text-placeholder: #94a3b8;
            
            --tab-active-bg: #334155;
            --tab-active-text: #ffffff;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: var(--text-main);
            transition: background-color 0.3s;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--border-color);
        }

        h2 { color: #ffffff; font-weight: 700; }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 12px 20px;
            border: none;
            background: transparent;
            font-size: 15px;
            font-weight: 600;
            color: var(--text-sub);
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover { background-color: var(--input-bg); color: #ffffff; }
        
        .tab-btn.active {
            background-color: var(--tab-active-bg);
            color: var(--tab-active-text);
            border: 1px solid var(--border-color);
        }

        /* í—¤ë” */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .search-box input {
            padding: 10px 16px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            width: 250px;
            font-size: 14px;
            color: var(--text-main);
        }

        .tab-content { display: none; animation: fadeIn 0.3s ease; }
        .tab-content.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ì…ë ¥ í¼ */
        .input-wrapper {
            background-color: #0f172a40;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 25px;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 12px;
        }

        /* ì…ë ¥ ë ˆì´ë¸” (ë‚ ì§œ ë“±) */
        .input-label {
            font-size: 12px;
            color: var(--text-sub);
            margin-bottom: 4px;
            margin-left: 4px;
            display: block;
        }

        input, select {
            padding: 12px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            width: 100%;
            box-sizing: border-box;
            color: var(--text-main);
        }
        
        /* ë‚ ì§œ ì…ë ¥ ì•„ì´ì½˜ ìƒ‰ìƒ ì¡°ì • */
        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }
        
        input::placeholder { color: var(--text-placeholder); }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
        }

        /* ë²„íŠ¼ */
        button { cursor: pointer; border: none; border-radius: 8px; transition: all 0.2s; font-weight: 600; }
        
        .btn-add { background-color: var(--primary-color); color: #ffffff; padding: 12px; width: 100%; }
        .btn-add:hover { background-color: var(--primary-hover); }

        .btn-copy { background-color: var(--input-bg); color: #ffffff; padding: 4px 8px; font-size: 11px; margin-left: 5px; border-radius: 4px; vertical-align: middle; border: 1px solid var(--border-color);}
        .btn-copy:hover { background-color: var(--border-color); }

        .btn-action { padding: 6px 10px; font-size: 14px; margin: 0 2px; color: #ffffff; }
        .btn-edit { background-color: var(--primary-color); }
        .btn-delete { background-color: var(--danger-color); } 
        .btn-save { background-color: var(--success-color); }
        .btn-cancel { background-color: var(--border-color); color: var(--text-main); }
        
        /* í…Œì´ë¸” */
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; min-width: 1200px; }
        
        th, td { 
            padding: 14px 10px; 
            text-align: left; 
            border-bottom: 1px solid var(--border-color); 
            vertical-align: middle; 
            color: var(--text-main);
        }
        
        th { 
            background-color: var(--input-bg); 
            color: #ffffff;
            font-weight: 700; 
            cursor: pointer; 
            user-select: none; 
            white-space: nowrap; 
        }
        
        th:hover { color: var(--primary-color); }
        tr:hover { background-color: #33415550; }

        /* ë°°ì§€ */
        .badge { padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 600; display: inline-block; white-space: nowrap;}
        .bg-green { background: #064e3b; color: #a7f3d0; border: 1px solid #059669; }
        .bg-yellow { background: #451a03; color: #fde68a; border: 1px solid #d97706; }
        .bg-red { background: #450a0a; color: #fecaca; border: 1px solid #dc2626; }
        .bg-blue { background: #172554; color: #bfdbfe; border: 1px solid #2563eb; }
        .bg-purple { background: #3b0764; color: #e9d5ff; border: 1px solid #7c3aed; }
        .bg-gray { background: #334155; color: #cbd5e1; border: 1px solid #475569; }

        /* API Key */
        .key-text { font-family: 'JetBrains Mono', monospace; background: #0f172a; padding: 4px; border: 1px solid var(--border-color); border-radius: 4px; color: #f472b6; }
        .usage-bar-bg { width: 100%; height: 8px; background: var(--input-bg); border-radius: 4px; overflow: hidden; margin-top: 4px; }
        .usage-bar-fill { height: 100%; transition: width 0.3s; }

        /* ë§í¬ */
        .yt-link-display { display: flex; align-items: center; gap: 5px; }
        .link-icon { text-decoration: none; color: var(--danger-color); font-size: 18px; }

        /* ëª¨ë‹¬ */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7); display: none;
            justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-content {
            background: var(--card-bg); padding: 25px; border-radius: 12px; width: 90%; max-width: 400px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5); border: 1px solid var(--border-color);
        }
        #modalTitle { margin-top:0; color: #ffffff; }
        #modalMessage { color: var(--text-sub); }
        .modal-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
        .btn-modal-confirm { background-color: var(--primary-color); color: #ffffff; padding: 8px 16px; }
        .btn-modal-delete { background-color: var(--danger-color); color: white; padding: 8px 16px; }

        #loading { display: none; color: var(--primary-color); font-weight: bold; margin-right: 10px;}
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“‚ í†µí•© ê´€ë¦¬ì </h2>
    
    <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="tabs">
        <button class="tab-btn active" onclick="switchTab('api')">ğŸ”‘ API Key</button>
        <button class="tab-btn" onclick="switchTab('youtube')">ğŸ“º ìœ íŠœë¸Œ ì±„ë„</button>
        <button class="tab-btn" onclick="switchTab('adsense')">ğŸ’° ì• ë“œì„¼ìŠ¤</button>
        <button class="tab-btn" onclick="switchTab('subscription')">ğŸ’³ êµ¬ë… ê´€ë¦¬</button>
    </nav>

    <!-- ê³µí†µ í—¤ë” -->
    <div class="section-header">
        <div style="display:flex; align-items:center;">
            <span id="loading">ğŸ“¡ ë™ê¸°í™” ì¤‘...</span>
            <div id="statsText" style="color: var(--text-sub); font-size: 14px;">ë°ì´í„° ë¡œë”© ì¤‘...</div>
        </div>
        <div class="search-box">
            <input type="text" id="searchInput" onkeyup="filterCurrentTable()" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">
        </div>
    </div>

    <!-- 1. API Key ë§¤ë‹ˆì € -->
    <div id="tab-api" class="tab-content active">
        <div class="input-wrapper">
            <div class="input-group">
                <input type="text" id="api_account" placeholder="êµ¬ê¸€ ê³„ì • (Email)">
                <input type="text" id="api_key" placeholder="API Key (sk-...)">
                <input type="text" id="api_usage" placeholder="ì£¼ ìš©ë„">
                <select id="api_status">
                    <option value="ì •ìƒ">ğŸŸ¢ ì •ìƒ</option>
                    <option value="ì œí•œë¨">ğŸŸ¡ ì œí•œë¨</option>
                    <option value="ë§Œë£Œ">ğŸ”´ ë§Œë£Œ</option>
                </select>
            </div>
            <div class="input-group">
                <input type="number" id="api_current" placeholder="ì‚¬ìš©ëŸ‰($)" step="0.01">
                <input type="number" id="api_max" placeholder="í• ë‹¹ëŸ‰($)" step="0.01">
                <input type="text" id="api_note" placeholder="ë¹„ê³ ">
                <button class="btn-add" onclick="addData('api')">+ API í‚¤ ì¶”ê°€</button>
            </div>
        </div>
        <div class="table-container">
            <table id="table-api">
                <thead>
                    <tr>
                        <th onclick="sortTable('account')">ê³„ì • â†•</th>
                        <th onclick="sortTable('apiKey')">API Key</th>
                        <th onclick="sortTable('usage')">ìš©ë„ â†•</th>
                        <th onclick="sortTable('percentage')">Quota ($) â†•</th>
                        <th onclick="sortTable('limitStatus')">ìƒíƒœ â†•</th>
                        <th onclick="sortTable('note')">ë¹„ê³ </th>
                        <th style="width:100px; text-align:center;">ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- 2. ìœ íŠœë¸Œ ì±„ë„ ê´€ë¦¬ -->
    <div id="tab-youtube" class="tab-content">
        <div class="input-wrapper">
            <div class="input-group" style="grid-template-columns: 1fr 1fr 1fr;">
                <input type="text" id="yt_owner" placeholder="ì£¼ ì†Œìœ ì ê³„ì • (Email)">
                <input type="text" id="yt_manager" placeholder="ì£¼ ê´€ë¦¬ì ê³„ì •">
                <input type="text" id="yt_pw" placeholder="ë¹„ë°€ë²ˆí˜¸">
            </div>
            <div class="input-group" style="grid-template-columns: 1fr 2fr 1fr;">
                <input type="text" id="yt_channel" placeholder="ì±„ë„ëª…">
                <input type="text" id="yt_link" placeholder="ìœ íŠœë¸Œ ë§í¬ (https://...)">
                <input type="text" id="yt_adsense_account" placeholder="ì• ë“œì„¼ìŠ¤ ê³„ì •">
            </div>
            <div class="input-group" style="grid-template-columns: 1fr 1fr 2fr;">
                <select id="yt_brand">
                    <option value="N">ë¸Œëœë“œ ê³„ì •: ì•„ë‹ˆì˜¤ (N)</option>
                    <option value="Y">ë¸Œëœë“œ ê³„ì •: ì˜ˆ (Y)</option>
                </select>
                <select id="yt_type">
                    <option value="ê°œì¸">ê°œì¸</option>
                    <option value="ê°œì¸ì‚¬ì—…ì">ê°œì¸ì‚¬ì—…ì</option>
                    <option value="ë²•ì¸ì‚¬ì—…ì">ë²•ì¸ì‚¬ì—…ì</option>
                </select>
                <input type="text" id="yt_address" placeholder="ì£¼ì†Œ">
            </div>
            <div class="input-group">
                <input type="text" id="yt_note" placeholder="ë¹„ê³ ">
                <button class="btn-add" onclick="addData('youtube')">+ ì±„ë„ ì¶”ê°€</button>
            </div>
        </div>
        <div class="table-container">
            <table id="table-youtube">
                <thead>
                    <tr>
                        <th onclick="sortTable('owner')">ì£¼ ì†Œìœ ì â†•</th>
                        <th onclick="sortTable('manager')">ì£¼ ê´€ë¦¬ì</th>
                        <th onclick="sortTable('channel')">ì±„ë„ ì •ë³´ (ë§í¬) â†•</th>
                        <th onclick="sortTable('adsenseAccount')">ì• ë“œì„¼ìŠ¤ ê³„ì • â†•</th>
                        <th onclick="sortTable('brand')">ë¸Œëœë“œ</th>
                        <th onclick="sortTable('type')">í˜•íƒœ â†•</th>
                        <th onclick="sortTable('address')">ì£¼ì†Œ</th>
                        <th style="width:100px; text-align:center;">ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- 3. ì• ë“œì„¼ìŠ¤ -->
    <div id="tab-adsense" class="tab-content">
        <div class="input-wrapper">
            <div class="input-group">
                <input type="text" id="ad_email" placeholder="ì• ë“œì„¼ìŠ¤ ê³„ì • (Email)">
                <input type="text" id="ad_pubid" placeholder="PUB-ID (pub-xxxxxxxx)">
                <input type="text" id="ad_site" placeholder="ì—°ë™ ì‚¬ì´íŠ¸/ì±„ë„ëª…">
            </div>
            <div class="input-group">
                <input type="text" id="ad_pin" placeholder="PIN ë²ˆí˜¸ (6ìë¦¬)">
                <select id="ad_status">
                    <option value="ìŠ¹ì¸ë¨">ğŸŸ¢ ìŠ¹ì¸ë¨ (Ready)</option>
                    <option value="ê²€í† ì¤‘">ğŸŸ¡ ê²€í† ì¤‘ (Review)</option>
                    <option value="ì¤€ë¹„í•„ìš”">ğŸ”´ ì¤€ë¹„í•„ìš” (Attention)</option>
                </select>
            </div>
            <div class="input-group" style="grid-template-columns: 1fr 2fr 1fr;">
                <input type="text" id="ad_bank" placeholder="ì—°ë™ ê³„ì¢Œ ì€í–‰ (ì˜ˆ: ì¹´ì¹´ì˜¤ë±…í¬)">
                <input type="text" id="ad_account_num" placeholder="ê³„ì¢Œë²ˆí˜¸">
                <input type="text" id="ad_account_holder" placeholder="ê³„ì¢Œëª…ì˜">
            </div>
            <div class="input-group">
                <input type="text" id="ad_note" placeholder="ë¹„ê³  (íŠ¹ì´ì‚¬í•­ ë“±)">
                <button class="btn-add" onclick="addData('adsense')">+ ì• ë“œì„¼ìŠ¤ ì¶”ê°€</button>
            </div>
        </div>
        <div class="table-container">
            <table id="table-adsense">
                <thead>
                    <tr>
                        <th onclick="sortTable('email')">ê³„ì • â†•</th>
                        <th onclick="sortTable('pubId')">PUB-ID</th>
                        <th onclick="sortTable('site')">ì‚¬ì´íŠ¸/ì±„ë„ â†•</th>
                        <th onclick="sortTable('pin')">PIN</th>
                        <th onclick="sortTable('bank')">ì •ì‚° ê³„ì¢Œ â†•</th>
                        <th onclick="sortTable('status')">ìƒíƒœ â†•</th>
                        <th onclick="sortTable('note')">ë¹„ê³ </th>
                        <th style="width:100px; text-align:center;">ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- 4. êµ¬ë… ê´€ë¦¬ (ì—…ë°ì´íŠ¸ë¨) -->
    <div id="tab-subscription" class="tab-content">
        <div class="input-wrapper">
            <!-- Row 1: ì„œë¹„ìŠ¤ ê¸°ë³¸ ì •ë³´ & ì£¼ê¸° -->
            <div class="input-group" style="grid-template-columns: 1.5fr 1fr 0.8fr 0.8fr;">
                <input type="text" id="sub_service" placeholder="ì„œë¹„ìŠ¤ëª… (Netflix, ChatGPT)">
                <input type="number" id="sub_cost" placeholder="ê²°ì œ ê¸ˆì•¡">
                <select id="sub_currency">
                    <option value="KRW">â‚© (KRW)</option>
                    <option value="USD">$ (USD)</option>
                </select>
                <select id="sub_cycle">
                    <option value="ì›”ê°„">ì›”ê°„</option>
                    <option value="ì—°ê°„">ì—°ê°„</option>
                </select>
            </div>
            
            <!-- Row 2: ë‚ ì§œ & êµ¬ë§¤ì²˜ -->
            <div class="input-group" style="grid-template-columns: 1fr 1fr 1fr;">
                <div style="display:flex; flex-direction:column;">
                    <label class="input-label">ê²°ì œì¼</label>
                    <input type="date" id="sub_date" placeholder="ê²°ì œì¼">
                </div>
                <div style="display:flex; flex-direction:column;">
                    <label class="input-label">ë§Œë£Œì¼</label>
                    <input type="date" id="sub_expire" placeholder="ë§Œë£Œì¼">
                </div>
                <div style="display:flex; flex-direction:column;">
                    <label class="input-label">êµ¬ë§¤ì²˜</label>
                    <input type="text" id="sub_vendor" placeholder="êµ¬ë§¤ì²˜ (App Store, Web)">
                </div>
            </div>

            <!-- Row 3: ê³„ì • ì •ë³´ -->
            <div class="input-group">
                <input type="text" id="sub_account" placeholder="ë¡œê·¸ì¸ ê³„ì • (ID/Email)">
                <input type="text" id="sub_pw" placeholder="ë¹„ë°€ë²ˆí˜¸">
            </div>

            <!-- Row 4: ê²°ì œìˆ˜ë‹¨ & ìƒíƒœ -->
            <div class="input-group">
                <input type="text" id="sub_method" placeholder="ê²°ì œ ìˆ˜ë‹¨ (í˜„ëŒ€ì¹´ë“œ, ì¹´ì¹´ì˜¤í˜ì´)">
                <select id="sub_status">
                    <option value="êµ¬ë…ì¤‘">ğŸ”µ êµ¬ë…ì¤‘</option>
                    <option value="í•´ì§€ì˜ˆì •">ğŸŸ¡ í•´ì§€ì˜ˆì •</option>
                    <option value="ì¢…ë£Œ">âšª ì¢…ë£Œë¨</option>
                </select>
            </div>

            <!-- Row 5: ë¹„ê³  & ì¶”ê°€ -->
            <div class="input-group" style="grid-template-columns: 3fr 1fr;">
                <input type="text" id="sub_note" placeholder="ë¹„ê³  (íŠ¹ì´ì‚¬í•­)">
                <button class="btn-add" onclick="addData('subscription')">+ êµ¬ë… ì¶”ê°€</button>
            </div>
        </div>
        <div class="table-container">
            <table id="table-subscription">
                <thead>
                    <tr>
                        <th onclick="sortTable('service')">ì„œë¹„ìŠ¤ëª… â†•</th>
                        <th onclick="sortTable('cost')">ê¸ˆì•¡ â†•</th>
                        <th onclick="sortTable('cycle')">ì£¼ê¸°</th>
                        <th onclick="sortTable('vendor')">êµ¬ë§¤ì²˜</th>
                        <th onclick="sortTable('date')">ê²°ì œì¼ â†•</th>
                        <th onclick="sortTable('expire')">ë§Œë£Œì¼ â†•</th>
                        <th onclick="sortTable('account')">ê³„ì •</th>
                        <th onclick="sortTable('pw')">ë¹„ë²ˆ</th>
                        <th onclick="sortTable('method')">ê²°ì œìˆ˜ë‹¨</th>
                        <th onclick="sortTable('status')">ìƒíƒœ â†•</th>
                        <th onclick="sortTable('note')">ë¹„ê³ </th>
                        <th style="width:100px; text-align:center;">ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>

<!-- í†µí•© ëª¨ë‹¬ ì°½ -->
<div id="customModal" class="modal-overlay">
    <div class="modal-content">
        <h3 id="modalTitle">ì•Œë¦¼</h3>
        <p id="modalMessage">ë‚´ìš©</p>
        <div class="modal-actions">
            <button class="btn-cancel" onclick="closeModal()">ì·¨ì†Œ</button>
            <button id="modalConfirmBtn" class="btn-modal-confirm" onclick="confirmModal()">í™•ì¸</button>
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

    // --- ìƒíƒœ ê´€ë¦¬ ---
    let db; 
    let auth;
    let userId = null;
    let appId = 'default-app-id';
    let currentTab = 'api';
    let sortState = { col: null, dir: 'asc' };
    let localData = { api: [], youtube: [], adsense: [], subscription: [] };
    let pendingModalAction = null;
    let unsubscribes = {}; 

    // --- ì´ˆê¸°í™” ---
    async function init() {
        try {
            let firebaseConfig;
            if (typeof __firebase_config !== 'undefined') {
                firebaseConfig = JSON.parse(__firebase_config);
                appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
            } else {
                try {
                    const response = await fetch('./firebase-config.json');
                    if (!response.ok) throw new Error("firebase-config.json íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    firebaseConfig = await response.json();
                    if(firebaseConfig.appId) appId = firebaseConfig.appId;
                } catch (e) {
                    throw new Error("ì„¤ì • ë¡œë“œ ì‹¤íŒ¨: firebase-config.json í™•ì¸ (" + e.message + ")");
                }
            }

            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);

            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                await signInWithCustomToken(auth, __initial_auth_token);
            } else {
                await signInAnonymously(auth);
            }
            
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    userId = user.uid;
                    setupListeners(); 
                } else {
                    console.error("ë¡œê·¸ì¸ ì‹¤íŒ¨");
                }
            });

        } catch (error) {
            console.error("Initialization Error:", error);
            alert("ì´ˆê¸°í™” ì˜¤ë¥˜: " + error.message);
        }
    }

    // --- Firestore ë¦¬ìŠ¤ë„ˆ ---
    function setupListeners() {
        const collections = ['api', 'youtube', 'adsense', 'subscription'];
        
        collections.forEach(colName => {
            const q = query(collection(db, 'artifacts', appId, 'users', userId, colName));
            
            if (unsubscribes[colName]) unsubscribes[colName]();

            document.getElementById('loading').style.display = 'inline';

            unsubscribes[colName] = onSnapshot(q, (snapshot) => {
                localData[colName] = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data(),
                    isEditing: false 
                }));
                if (currentTab === colName) renderCurrentTable();
                document.getElementById('loading').style.display = 'none';
            }, (error) => {
                console.error(`Error reading ${colName}:`, error);
                document.getElementById('loading').style.display = 'none';
            });
        });
    }

    // --- íƒ­ ì „í™˜ ---
    window.switchTab = (tabName) => {
        currentTab = tabName;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        
        const tabMap = { 'api': 0, 'youtube': 1, 'adsense': 2, 'subscription': 3 };
        const btns = document.querySelectorAll('.tab-btn');
        if(btns[tabMap[tabName]]) btns[tabMap[tabName]].classList.add('active');

        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        document.getElementById(`tab-${tabName}`).classList.add('active');

        document.getElementById('searchInput').value = '';
        renderCurrentTable();
    }

    // --- CRUD Operations ---

    window.addData = async (type) => {
        if (!userId) return alert("ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¤‘ì…ë‹ˆë‹¤...");
        
        let newData = {};

        if(type === 'api') {
            const acc = document.getElementById('api_account').value;
            const key = document.getElementById('api_key').value;
            if(!acc || !key) return alert('í•„ìˆ˜ ì…ë ¥ ëˆ„ë½');
            newData = {
                account: acc, apiKey: key,
                usage: document.getElementById('api_usage').value,
                limitStatus: document.getElementById('api_status').value,
                currentUsed: parseFloat(document.getElementById('api_current').value) || 0,
                maxQuota: parseFloat(document.getElementById('api_max').value) || 0,
                note: document.getElementById('api_note').value
            };
        } 
        else if(type === 'youtube') {
            const ch = document.getElementById('yt_channel').value;
            const owner = document.getElementById('yt_owner').value;
            if(!ch || !owner) return alert('í•„ìˆ˜ ì…ë ¥ ëˆ„ë½');
            newData = {
                owner, channel: ch,
                manager: document.getElementById('yt_manager').value,
                pw: document.getElementById('yt_pw').value,
                link: document.getElementById('yt_link').value,
                adsenseAccount: document.getElementById('yt_adsense_account').value,
                brand: document.getElementById('yt_brand').value,
                type: document.getElementById('yt_type').value,
                address: document.getElementById('yt_address').value,
                note: document.getElementById('yt_note').value
            };
        }
        else if(type === 'adsense') {
            const pub = document.getElementById('ad_pubid').value;
            if(!pub) return alert('PUB-ID í•„ìˆ˜');
            newData = {
                email: document.getElementById('ad_email').value,
                pubId: pub,
                site: document.getElementById('ad_site').value,
                pin: document.getElementById('ad_pin').value,
                bank: document.getElementById('ad_bank').value,
                accountNum: document.getElementById('ad_account_num').value,
                accountHolder: document.getElementById('ad_account_holder').value,
                status: document.getElementById('ad_status').value,
                note: document.getElementById('ad_note').value
            };
        }
        else if(type === 'subscription') {
            const svc = document.getElementById('sub_service').value;
            if(!svc) return alert('ì„œë¹„ìŠ¤ëª… í•„ìˆ˜');
            newData = {
                service: svc,
                cost: document.getElementById('sub_cost').value,
                currency: document.getElementById('sub_currency').value,
                cycle: document.getElementById('sub_cycle').value, 
                vendor: document.getElementById('sub_vendor').value,
                date: document.getElementById('sub_date').value,
                expire: document.getElementById('sub_expire').value,
                account: document.getElementById('sub_account').value,
                pw: document.getElementById('sub_pw').value,
                method: document.getElementById('sub_method').value,
                status: document.getElementById('sub_status').value,
                note: document.getElementById('sub_note').value // New
            };
        }

        try {
            await addDoc(collection(db, 'artifacts', appId, 'users', userId, type), newData);
            clearInputs('tab-' + type);
        } catch (e) {
            alert("ì €ì¥ ì‹¤íŒ¨: " + e.message);
        }
    }

    function clearInputs(tabId) {
        document.querySelectorAll(`#${tabId} input`).forEach(i => i.value = '');
    }

    window.setEditMode = (id, mode) => {
        const item = localData[currentTab].find(d => d.id === id);
        if(item) {
            item.isEditing = mode;
            renderCurrentTable(); 
        }
    }

    window.saveEdit = async (id) => {
        const item = localData[currentTab].find(d => d.id === id);
        if(!item) return;

        let updates = {};
        
        if(currentTab === 'api') {
            updates = {
                account: document.getElementById(`e_acc_${id}`).value,
                apiKey: document.getElementById(`e_key_${id}`).value,
                usage: document.getElementById(`e_use_${id}`).value,
                currentUsed: parseFloat(document.getElementById(`e_cur_${id}`).value) || 0,
                maxQuota: parseFloat(document.getElementById(`e_max_${id}`).value) || 0,
                limitStatus: document.getElementById(`e_stat_${id}`).value,
                note: document.getElementById(`e_note_${id}`).value
            };
        } else if (currentTab === 'youtube') {
            updates = {
                owner: document.getElementById(`e_own_${id}`).value,
                manager: document.getElementById(`e_mgr_${id}`).value,
                pw: document.getElementById(`e_pw_${id}`).value,
                channel: document.getElementById(`e_ch_${id}`).value,
                link: document.getElementById(`e_lnk_${id}`).value,
                adsenseAccount: document.getElementById(`e_ads_acc_${id}`).value,
                brand: document.getElementById(`e_br_${id}`).value,
                type: document.getElementById(`e_typ_${id}`).value,
                address: document.getElementById(`e_addr_${id}`).value
            };
        } else if (currentTab === 'adsense') {
            updates = {
                email: document.getElementById(`e_email_${id}`).value,
                pubId: document.getElementById(`e_pub_${id}`).value,
                site: document.getElementById(`e_site_${id}`).value,
                pin: document.getElementById(`e_pin_${id}`).value,
                bank: document.getElementById(`e_bk_${id}`).value,
                accountNum: document.getElementById(`e_an_${id}`).value,
                accountHolder: document.getElementById(`e_ah_${id}`).value,
                status: document.getElementById(`e_stat_${id}`).value,
                note: document.getElementById(`e_note_${id}`).value
            };
        } else if (currentTab === 'subscription') {
            updates = {
                service: document.getElementById(`e_svc_${id}`).value,
                cost: document.getElementById(`e_cost_${id}`).value,
                currency: document.getElementById(`e_curr_${id}`).value,
                cycle: document.getElementById(`e_cycle_${id}`).value,
                vendor: document.getElementById(`e_vendor_${id}`).value,
                date: document.getElementById(`e_date_${id}`).value,
                expire: document.getElementById(`e_exp_${id}`).value,
                account: document.getElementById(`e_acc_${id}`).value,
                pw: document.getElementById(`e_pw_${id}`).value,
                method: document.getElementById(`e_met_${id}`).value,
                status: document.getElementById(`e_stat_${id}`).value,
                note: document.getElementById(`e_note_${id}`).value // New
            };
        }

        try {
            await updateDoc(doc(db, 'artifacts', appId, 'users', userId, currentTab, id), updates);
        } catch (e) {
            alert("ìˆ˜ì • ì‹¤íŒ¨: " + e.message);
        }
    }

    window.confirmDelete = (id) => {
        showModal('delete', 'âš ï¸ ì‚­ì œ í™•ì¸', 'ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', async () => {
            try {
                await deleteDoc(doc(db, 'artifacts', appId, 'users', userId, currentTab, id));
            } catch (e) {
                alert("ì‚­ì œ ì‹¤íŒ¨: " + e.message);
            }
        });
    }

    // --- ë Œë”ë§ ë¡œì§ ---
    window.renderCurrentTable = (filterText = '') => {
        if (!localData[currentTab]) return;
        
        const filterVal = filterText || document.getElementById('searchInput').value;
        const tbody = document.querySelector(`#table-${currentTab} tbody`);
        tbody.innerHTML = '';

        const filtered = localData[currentTab].filter(item => {
            const { isEditing, id, ...rest } = item; 
            const valStr = Object.values(rest).join(' ').toLowerCase();
            return valStr.includes(filterVal.toLowerCase());
        });

        if (sortState.col) {
            filtered.sort((a, b) => {
                let va = a[sortState.col] || '';
                let vb = b[sortState.col] || '';
                
                if (currentTab === 'api' && sortState.col === 'percentage') {
                    va = (a.maxQuota > 0) ? (a.currentUsed / a.maxQuota) : 0;
                    vb = (b.maxQuota > 0) ? (b.currentUsed / b.maxQuota) : 0;
                }
                if (currentTab === 'subscription' && (sortState.col === 'cost')) {
                    va = parseFloat(va) || 0; vb = parseFloat(vb) || 0;
                }

                if (va < vb) return sortState.dir === 'asc' ? -1 : 1;
                if (va > vb) return sortState.dir === 'asc' ? 1 : -1;
                return 0;
            });
        }

        document.getElementById('statsText').innerText = `ì´ ${filtered.length}ê°œ í•­ëª©`;

        if (filtered.length === 0) {
            tbody.innerHTML = `<tr><td colspan="12" style="text-align:center; padding:30px; color:var(--text-sub);">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
            return;
        }
        
        filtered.forEach(item => {
            const tr = document.createElement('tr');
            tr.innerHTML = item.isEditing ? getEditRowHTML(item) : getViewRowHTML(item);
            tbody.appendChild(tr);
        });
    }

    // --- Row Generators ---
    
    function getViewRowHTML(item) {
        const id = item.id;
        
        if (currentTab === 'api') {
            const percent = (item.maxQuota > 0) ? Math.min((item.currentUsed / item.maxQuota) * 100, 100) : 0;
            let barColor = 'var(--success-color)';
            if(percent >= 70) barColor = 'var(--warning-color)';
            if(percent >= 90) barColor = 'var(--danger-color)';
            const statusClass = item.limitStatus === 'ì •ìƒ' ? 'bg-green' : (item.limitStatus === 'ì œí•œë¨' ? 'bg-yellow' : 'bg-red');

            return `
                <td>${item.account}</td>
                <td><span class="key-text" title="${item.apiKey}">${maskString(item.apiKey, 8)}</span> <button class="btn-copy" onclick="copyText('${item.apiKey}')">Copy</button></td>
                <td>${item.usage}</td>
                <td>
                    <div style="font-size:11px; display:flex; justify-content:space-between;">
                        <span>$${item.currentUsed}</span><span>$${item.maxQuota}</span>
                    </div>
                    <div class="usage-bar-bg"><div class="usage-bar-fill" style="width:${percent}%; background:${barColor}"></div></div>
                </td>
                <td><span class="badge ${statusClass}">${item.limitStatus}</span></td>
                <td>${item.note}</td>
                <td style="text-align:center;">
                    <button class="btn-action btn-edit" onclick="setEditMode('${id}', true)">âœï¸</button>
                    <button class="btn-action btn-delete" onclick="confirmDelete('${id}')">ğŸ—‘ï¸</button>
                </td>
            `;
        } else if (currentTab === 'youtube') {
            const owner = item.owner || item.email || '-';
            const linkHtml = item.link ? 
                `<div class="yt-link-display">
                    <a href="${item.link}" target="_blank" class="link-icon">â–¶</a>
                    <button class="btn-copy" onclick="copyText('${item.link}')">Copy</button>
                 </div>` : '';

            return `
                <td>
                    <div style="font-weight:bold;">${owner}</div>
                    <div style="font-size:12px; color:var(--text-sub); cursor:pointer;" onclick="alert('PW: ${item.pw || 'ì—†ìŒ'}')">ğŸ”’ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</div>
                </td>
                <td>${item.manager || '-'}</td>
                <td>
                    <div style="font-weight:bold;">${item.channel}</div>
                    ${linkHtml}
                </td>
                <td>${item.adsenseAccount || '-'}</td>
                <td><span class="badge ${item.brand === 'Y' ? 'bg-blue' : 'bg-gray'}">${item.brand === 'Y' ? 'ë¸Œëœë“œ' : 'ì¼ë°˜'}</span></td>
                <td>${item.type || '-'}</td>
                <td title="${item.address || ''}">${maskString(item.address || '-', 10)}</td>
                <td style="text-align:center;">
                    <button class="btn-action btn-edit" onclick="setEditMode('${id}', true)">âœï¸</button>
                    <button class="btn-action btn-delete" onclick="confirmDelete('${id}')">ğŸ—‘ï¸</button>
                </td>
            `;
        } else if (currentTab === 'adsense') {
            const stClass = item.status === 'ìŠ¹ì¸ë¨' ? 'bg-green' : (item.status === 'ê²€í† ì¤‘' ? 'bg-yellow' : 'bg-red');
            return `
                <td>${item.email}</td>
                <td style="font-family:monospace;">${item.pubId}</td>
                <td style="font-weight:bold;">${item.site}</td>
                <td style="font-family:monospace; color:var(--text-sub);">${item.pin || '-'}</td>
                <td>
                    <div style="font-weight:bold;">${item.bank || '-'}</div>
                    <div style="font-size:12px;">${item.accountNum || '-'}</div>
                    <div style="font-size:11px; color:var(--text-sub);">${item.accountHolder || ''}</div>
                </td>
                <td><span class="badge ${stClass}">${item.status}</span></td>
                <td>${item.note}</td>
                <td style="text-align:center;">
                    <button class="btn-action btn-edit" onclick="setEditMode('${id}', true)">âœï¸</button>
                    <button class="btn-action btn-delete" onclick="confirmDelete('${id}')">ğŸ—‘ï¸</button>
                </td>
            `;
        } else if (currentTab === 'subscription') {
            const stClass = item.status === 'êµ¬ë…ì¤‘' ? 'bg-blue' : (item.status === 'í•´ì§€ì˜ˆì •' ? 'bg-yellow' : 'bg-gray');
            const currencySymbol = item.currency === 'KRW' ? 'â‚©' : '$';
            return `
                <td style="font-weight:bold;">${item.service}</td>
                <td>${currencySymbol} ${Number(item.cost).toLocaleString()}</td>
                <td>${item.cycle || 'ì›”ê°„'}</td>
                <td>${item.vendor || '-'}</td>
                <td>${item.date || '-'}</td>
                <td style="color:var(--text-sub);">${item.expire || '-'}</td>
                <td>${item.account || '-'}</td>
                <td>
                    <div style="font-size:12px; color:var(--text-sub); cursor:pointer;" onclick="alert('PW: ${item.pw || 'ì—†ìŒ'}')">ğŸ”’ í™•ì¸</div>
                </td>
                <td>${item.method}</td>
                <td><span class="badge ${stClass}">${item.status}</span></td>
                <td>${item.note || '-'}</td>
                <td style="text-align:center;">
                    <button class="btn-action btn-edit" onclick="setEditMode('${id}', true)">âœï¸</button>
                    <button class="btn-action btn-delete" onclick="confirmDelete('${id}')">ğŸ—‘ï¸</button>
                </td>
            `;
        }
    }

    function getEditRowHTML(item) {
        const id = item.id;
        
        if (currentTab === 'api') {
            return `
                <td><input id="e_acc_${id}" value="${item.account}"></td>
                <td><input id="e_key_${id}" value="${item.apiKey}"></td>
                <td><input id="e_use_${id}" value="${item.usage}"></td>
                <td>
                    <input id="e_cur_${id}" value="${item.currentUsed}" type="number" step="0.01" style="width:45%"> / 
                    <input id="e_max_${id}" value="${item.maxQuota}" type="number" step="0.01" style="width:45%">
                </td>
                <td>
                    <select id="e_stat_${id}">
                        <option value="ì •ìƒ" ${item.limitStatus==='ì •ìƒ'?'selected':''}>ì •ìƒ</option>
                        <option value="ì œí•œë¨" ${item.limitStatus==='ì œí•œë¨'?'selected':''}>ì œí•œë¨</option>
                        <option value="ë§Œë£Œ" ${item.limitStatus==='ë§Œë£Œ'?'selected':''}>ë§Œë£Œ</option>
                    </select>
                </td>
                <td><input id="e_note_${id}" value="${item.note}"></td>
                <td style="text-align:center;">
                    <button class="btn-action btn-save" onclick="saveEdit('${id}')">ğŸ’¾</button>
                    <button class="btn-action btn-cancel" onclick="setEditMode('${id}', false)">âŒ</button>
                </td>
            `;
        } else if (currentTab === 'youtube') {
             return `
                <td>
                    <input id="e_own_${id}" value="${item.owner || item.email || ''}" placeholder="ì†Œìœ ì">
                    <input id="e_pw_${id}" value="${item.pw || ''}" placeholder="ë¹„ë²ˆ" style="margin-top:2px;">
                </td>
                <td><input id="e_mgr_${id}" value="${item.manager || ''}"></td>
                <td>
                    <input id="e_ch_${id}" value="${item.channel}" placeholder="ì±„ë„ëª…">
                    <input id="e_lnk_${id}" value="${item.link || ''}" placeholder="URL" style="margin-top:2px;">
                </td>
                <td><input id="e_ads_acc_${id}" value="${item.adsenseAccount || ''}" placeholder="ì• ë“œì„¼ìŠ¤ ê³„ì •"></td>
                <td>
                    <select id="e_br_${id}">
                        <option value="Y" ${item.brand==='Y'?'selected':''}>Y (ë¸Œëœë“œ)</option>
                        <option value="N" ${item.brand==='N'?'selected':''}>N (ì¼ë°˜)</option>
                    </select>
                </td>
                <td>
                    <select id="e_typ_${id}">
                        <option value="ê°œì¸" ${item.type==='ê°œì¸'?'selected':''}>ê°œì¸</option>
                        <option value="ê°œì¸ì‚¬ì—…ì" ${item.type==='ê°œì¸ì‚¬ì—…ì'?'selected':''}>ê°œì¸ì‚¬ì—…ì</option>
                        <option value="ë²•ì¸ì‚¬ì—…ì" ${item.type==='ë²•ì¸ì‚¬ì—…ì'?'selected':''}>ë²•ì¸ì‚¬ì—…ì</option>
                    </select>
                </td>
                <td><input id="e_addr_${id}" value="${item.address || ''}"></td>
                <td style="text-align:center;">
                    <button class="btn-action btn-save" onclick="saveEdit('${id}')">ğŸ’¾</button>
                    <button class="btn-action btn-cancel" onclick="setEditMode('${id}', false)">âŒ</button>
                </td>
            `;
        } else if (currentTab === 'adsense') {
            return `
                <td><input id="e_email_${id}" value="${item.email}"></td>
                <td><input id="e_pub_${id}" value="${item.pubId}"></td>
                <td><input id="e_site_${id}" value="${item.site}"></td>
                <td><input id="e_pin_${id}" value="${item.pin || ''}" placeholder="PIN"></td>
                <td>
                    <input id="e_bk_${id}" value="${item.bank || ''}" placeholder="ì€í–‰">
                    <input id="e_an_${id}" value="${item.accountNum || ''}" placeholder="ê³„ì¢Œë²ˆí˜¸" style="margin-top:2px;">
                    <input id="e_ah_${id}" value="${item.accountHolder || ''}" placeholder="ì˜ˆê¸ˆì£¼" style="margin-top:2px;">
                </td>
                <td>
                    <select id="e_stat_${id}">
                        <option value="ìŠ¹ì¸ë¨" ${item.status==='ìŠ¹ì¸ë¨'?'selected':''}>ìŠ¹ì¸ë¨</option>
                        <option value="ê²€í† ì¤‘" ${item.status==='ê²€í† ì¤‘'?'selected':''}>ê²€í† ì¤‘</option>
                        <option value="ì¤€ë¹„í•„ìš”" ${item.status==='ì¤€ë¹„í•„ìš”'?'selected':''}>ì¤€ë¹„í•„ìš”</option>
                    </select>
                </td>
                <td><input id="e_note_${id}" value="${item.note}"></td>
                <td style="text-align:center;">
                    <button class="btn-action btn-save" onclick="saveEdit('${id}')">ğŸ’¾</button>
                    <button class="btn-action btn-cancel" onclick="setEditMode('${id}', false)">âŒ</button>
                </td>
            `;
        } else if (currentTab === 'subscription') {
            return `
                <td><input id="e_svc_${id}" value="${item.service}"></td>
                <td>
                    <input id="e_cost_${id}" value="${item.cost}" type="number" style="width:60%">
                    <select id="e_curr_${id}" style="width:35%">
                        <option value="KRW" ${item.currency==='KRW'?'selected':''}>â‚©</option>
                        <option value="USD" ${item.currency==='USD'?'selected':''}>$</option>
                    </select>
                </td>
                <td>
                    <select id="e_cycle_${id}">
                        <option value="ì›”ê°„" ${item.cycle==='ì›”ê°„'?'selected':''}>ì›”ê°„</option>
                        <option value="ì—°ê°„" ${item.cycle==='ì—°ê°„'?'selected':''}>ì—°ê°„</option>
                    </select>
                </td>
                <td><input id="e_vendor_${id}" value="${item.vendor || ''}"></td>
                <td><input id="e_date_${id}" value="${item.date}" type="date"></td>
                <td><input id="e_exp_${id}" value="${item.expire || ''}" type="date"></td>
                <td><input id="e_acc_${id}" value="${item.account || ''}"></td>
                <td><input id="e_pw_${id}" value="${item.pw || ''}"></td>
                <td><input id="e_met_${id}" value="${item.method}"></td>
                <td>
                    <select id="e_stat_${id}">
                        <option value="êµ¬ë…ì¤‘" ${item.status==='êµ¬ë…ì¤‘'?'selected':''}>êµ¬ë…ì¤‘</option>
                        <option value="í•´ì§€ì˜ˆì •" ${item.status==='í•´ì§€ì˜ˆì •'?'selected':''}>í•´ì§€ì˜ˆì •</option>
                        <option value="ì¢…ë£Œ" ${item.status==='ì¢…ë£Œ'?'selected':''}>ì¢…ë£Œ</option>
                    </select>
                </td>
                <td><input id="e_note_${id}" value="${item.note || ''}"></td>
                <td style="text-align:center;">
                    <button class="btn-action btn-save" onclick="saveEdit('${id}')">ğŸ’¾</button>
                    <button class="btn-action btn-cancel" onclick="setEditMode('${id}', false)">âŒ</button>
                </td>
            `;
        }
    }

    // --- ìœ í‹¸ë¦¬í‹° (Global expose) ---
    window.filterCurrentTable = () => renderCurrentTable();
    
    window.sortTable = (col) => {
        if(sortState.col === col) sortState.dir = sortState.dir === 'asc' ? 'desc' : 'asc';
        else { sortState.col = col; sortState.dir = 'asc'; }
        renderCurrentTable();
    }

    window.maskString = (str, len) => {
        if(!str) return '';
        if(str.length <= len) return str;
        return str.substring(0, len) + '...';
    }

    window.copyText = (text) => {
        navigator.clipboard.writeText(text).then(() => {
            showModal('alert', 'ë³µì‚¬ ì™„ë£Œ', 'í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
        });
    }

    window.showModal = (type, title, msg, callback) => {
        const modal = document.getElementById('customModal');
        const btnConfirm = document.getElementById('modalConfirmBtn');
        const cancelBtn = document.querySelector('.btn-cancel');

        document.getElementById('modalTitle').innerText = title;
        document.getElementById('modalMessage').innerText = msg;
        pendingModalAction = callback;

        btnConfirm.style.display = 'block';
        cancelBtn.style.display = 'block';

        if(type === 'delete') {
            btnConfirm.className = 'btn-modal-delete';
            btnConfirm.innerText = 'ì‚­ì œ';
        } else if(type === 'alert') {
            btnConfirm.className = 'btn-modal-confirm';
            btnConfirm.innerText = 'í™•ì¸';
            cancelBtn.style.display = 'none'; 
        }
        modal.style.display = 'flex';
    }

    window.closeModal = () => {
        document.getElementById('customModal').style.display = 'none';
        pendingModalAction = null;
    }

    window.confirmModal = () => {
        if(pendingModalAction) pendingModalAction();
        closeModal();
    }

    // --- ì•± ì‹œì‘ ---
    init();

</script>
</body>
</html>



